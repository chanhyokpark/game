# 모든 자원과 플래그는 아이템으로 구성되고, 화면은 노드로 구성됨
# dest가 있는 경우, 텍스트를 표시하지 않고 바로 넘어감
# dest가 있고 random이 true인 경우, 조건에 맞는 선택지를 고르고 가중치에 맞게 랜덤으로 고름
# dest가 없는 경우, 텍스트와 분기를 표시함
# 모든 text는 앞에 $를 붙일 수 있음, 이 경우 texts에 명시된 작업 수행

# 특수 노드
# _after_branch: 선택지 누른 다음 무조건 실행됨


nodes:
  death:
    text: '결국 당신은 쓰러지고 말았습니다. 당신의 여정은 여기서 종료됩니다...'
    image: 죽음
    branch:
      - text: 재시작
        id: _restart

  _after_branch:
    random: true
    dest:
      - cond:
          hp: 0
        id: death
        weight: 1000000000
      - cond:
          item1: 2
        id: special_1
        weight: 100
      - cond:
          item2: true
        id: special_2
        weight: 1

  select_1:
    random: true #  조건 맞는 거중 랜덤
    dest:
      - cond:
          item1: '>3'
          item2: true
        id: node_1
        weight: 3
      - cond:
          item1: 2
        id: node_2
        weight: 5
      - id: node_3 # 기본값
        weight: 0.01

  select_2: # 조건 맞는 것중 최상위
    dest:
      - cond:
          item1: '!2'
          item3: false
        id: node_4
      - id: node_5

  node_1:
    text: '당신은 갈림길에 도달합니다. 표지판 하나는 ~라고 써져 있고, (...)'
    image: node_1
    next: # 바로 다음으로 넘어가기
      id: node_2

  node_2:
    text: '어디로 갈까요?'
    branch:
      - cond:
          item1: 2
          item2: true
          visited_node_2_1: false
        hide: true # 조건 충족시키지 못하면 숨기기
        set:
          item1: '-=2' # 2만큼 빼기
          item3: true
          hp: 3 # 3으로 맞추기
        text: '주변을 분석한다'
        id: node_2_1
      - text: '왼쪽 갈림길'
        set:
          hp: 0
        id: node_2_2
      - text: '오른쪽 갈림길'
        id: node_3

  node_2_1:
    text: '당신은 왼쪽 갈림길에 함정이 있는 것을 발견합니다!'
    next:
      id: node_2
      set:
        visited_node_2_1: true
      text: '다행이다'

  node_2_2:
    text: '당신은 함정에 빠집니다!'
    next:
      id: node_3
      text: '아야'

  hub:
    text: $hub_text
    branch: # 허브에서 갈 수 있는 지역들/퀘스트 표시
      - id: node_8
        text: '마을로 이동'

texts:
  hub_text:
    dest:
      - cond:
          item1: 0
        text: '텍스트 1'
      - cond:
          item2: 1
        text: '텍스트 2'
      - text: '기본값 텍스트'